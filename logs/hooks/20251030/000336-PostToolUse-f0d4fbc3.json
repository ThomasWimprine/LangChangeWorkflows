{"session_id":"f0d4fbc3-a5b1-443e-8264-7550e32cfe6a","transcript_path":"/home/thomas/.claude/projects/-home-thomas-Repositories-LangChangeWorkflows/f0d4fbc3-a5b1-443e-8264-7550e32cfe6a.jsonl","cwd":"/home/thomas/Repositories/LangChangeWorkflows","permission_mode":"acceptEdits","hook_event_name":"PostToolUse","tool_name":"Write","tool_input":{"file_path":"/home/thomas/Repositories/LangChangeWorkflows/langgraph/config/default_gates.yaml","content":"# Default Gate Configuration for PRP Workflows\n# This configuration is deployed to ~/.claude/langgraph/config/default_gates.yaml\n# Projects can override by creating .claude/langgraph/config/gates.yaml\n\nversion: \"1.0\"\n\n# Global Settings\nglobal:\n  max_retries: 3                    # Maximum retries per gate (3-strike rule)\n  circuit_breaker_threshold: 15     # Consecutive failures before circuit breaker\n  enable_context_optimization: true # Enable cost-saving context sharing\n  enable_checkpointing: true        # Enable state persistence\n\n# Gate Definitions\ngates:\n  # Gate 1: TDD Cycle Verification\n  gate_1_tdd:\n    enabled: true\n    blocking: true                  # Must pass to continue\n    name: \"TDD Cycle Verification\"\n    description: \"Verifies RED-GREEN-REFACTOR pattern in commit history\"\n    validation_method: \"git_history_analysis\"\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 1500\n\n  # Gate 2: Test Coverage (Phase 0 POC)\n  gate_2_coverage:\n    enabled: true\n    blocking: true\n    name: \"Test Coverage\"\n    description: \"Validates 100% test coverage (lines, branches, functions, statements)\"\n    validation_method: \"pytest_cov\"\n    threshold: 100                  # Coverage percentage required\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 2000\n    cache_ttl_minutes: 5\n\n  # Gate 3: Mock Detection\n  gate_3_mock:\n    enabled: true\n    blocking: true\n    name: \"Mock Detection\"\n    description: \"Ensures zero mocks/stubs/test doubles in production code (src/)\"\n    validation_method: \"static_analysis\"\n    allowed_directories:\n      - \"tests/\"\n      - \"test/\"\n      - \"spec/\"\n    blocked_patterns:\n      - \"Mock\"\n      - \"Stub\"\n      - \"Fake\"\n      - \"Spy\"\n      - \"mock(\"\n      - \"patch(\"\n    specialist_agent: \"python-developer\"  # Language-specific\n    cost_estimate_tokens: 1000\n\n  # Gate 4: Mutation Testing\n  gate_4_mutation:\n    enabled: true\n    blocking: true\n    name: \"Mutation Testing\"\n    description: \"Validates mutation score ≥95% to ensure test effectiveness\"\n    validation_method: \"mutation_testing\"\n    threshold: 95                   # Mutation score percentage\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 3000\n    timeout_seconds: 600            # 10 minutes for mutation testing\n\n  # Gate 5: Security Validation\n  gate_5_security:\n    enabled: true\n    blocking: true\n    name: \"Security Validation\"\n    description: \"Scans for critical/high vulnerabilities and security issues\"\n    validation_method: \"security_scan\"\n    allowed_severity_levels:\n      - \"low\"\n      - \"informational\"\n    blocked_severity_levels:\n      - \"critical\"\n      - \"high\"\n    scan_tools:\n      - \"bandit\"         # Python security scanner\n      - \"safety\"         # Python dependency scanner\n      - \"semgrep\"        # Multi-language static analysis\n    specialist_agent: \"security-reviewer\"\n    cost_estimate_tokens: 2500\n\n  # Gate 6: Production-Ready Standards\n  gate_6_production_ready:\n    enabled: true\n    blocking: true\n    name: \"Production-Ready Standards\"\n    description: \"Validates completeness: no stubs, full error handling, comprehensive logging\"\n    validation_method: \"production_ready_scan\"\n    checks:\n      - \"no_stub_implementations\"\n      - \"complete_error_handling\"\n      - \"structured_logging\"\n      - \"no_unresolved_todos\"\n    completeness_threshold: 100     # Perfect score required\n    specialist_agent: \"architect-reviewer\"\n    cost_estimate_tokens: 2000\n\n# Failure Handling Configuration\nfailure_handling:\n  # 3-Strike Rule\n  retry_strategy: \"exponential_backoff\"\n  initial_retry_delay_seconds: 5\n  max_retry_delay_seconds: 60\n  backoff_multiplier: 2.0\n\n  # Specialist Consultation\n  consult_after_failures: 3         # Consult specialist after 3 failures\n  specialist_timeout_seconds: 300   # 5 minutes for specialist response\n\n  # Circuit Breaker\n  circuit_breaker:\n    enabled: true\n    threshold: 15                   # Consecutive failures\n    reset_after_success: true       # Reset counter on any successful gate\n    manual_intervention_required: true\n\n# Cost Optimization\ncost_optimization:\n  enable_context_sharing: true\n  enable_result_caching: true\n  cache_ttl:\n    coverage_results: 300           # 5 minutes\n    agent_responses: 600            # 10 minutes\n    file_contents: 900              # 15 minutes\n\n  # Estimated costs (USD) per gate with optimization\n  estimated_costs:\n    gate_1_tdd: 0.02\n    gate_2_coverage: 0.03\n    gate_3_mock: 0.015\n    gate_4_mutation: 0.045\n    gate_5_security: 0.0375\n    gate_6_production_ready: 0.03\n    total_per_prp: 0.1725           # ~40% savings vs non-optimized\n\n# Monitoring and Metrics\nmonitoring:\n  track_cost_savings: true\n  track_cache_hit_rate: true\n  track_gate_pass_rates: true\n  track_specialist_effectiveness: true\n  export_metrics_format: \"json\"\n  metrics_output_path: \".langgraph/metrics/\"\n"},"tool_response":{"type":"create","filePath":"/home/thomas/Repositories/LangChangeWorkflows/langgraph/config/default_gates.yaml","content":"# Default Gate Configuration for PRP Workflows\n# This configuration is deployed to ~/.claude/langgraph/config/default_gates.yaml\n# Projects can override by creating .claude/langgraph/config/gates.yaml\n\nversion: \"1.0\"\n\n# Global Settings\nglobal:\n  max_retries: 3                    # Maximum retries per gate (3-strike rule)\n  circuit_breaker_threshold: 15     # Consecutive failures before circuit breaker\n  enable_context_optimization: true # Enable cost-saving context sharing\n  enable_checkpointing: true        # Enable state persistence\n\n# Gate Definitions\ngates:\n  # Gate 1: TDD Cycle Verification\n  gate_1_tdd:\n    enabled: true\n    blocking: true                  # Must pass to continue\n    name: \"TDD Cycle Verification\"\n    description: \"Verifies RED-GREEN-REFACTOR pattern in commit history\"\n    validation_method: \"git_history_analysis\"\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 1500\n\n  # Gate 2: Test Coverage (Phase 0 POC)\n  gate_2_coverage:\n    enabled: true\n    blocking: true\n    name: \"Test Coverage\"\n    description: \"Validates 100% test coverage (lines, branches, functions, statements)\"\n    validation_method: \"pytest_cov\"\n    threshold: 100                  # Coverage percentage required\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 2000\n    cache_ttl_minutes: 5\n\n  # Gate 3: Mock Detection\n  gate_3_mock:\n    enabled: true\n    blocking: true\n    name: \"Mock Detection\"\n    description: \"Ensures zero mocks/stubs/test doubles in production code (src/)\"\n    validation_method: \"static_analysis\"\n    allowed_directories:\n      - \"tests/\"\n      - \"test/\"\n      - \"spec/\"\n    blocked_patterns:\n      - \"Mock\"\n      - \"Stub\"\n      - \"Fake\"\n      - \"Spy\"\n      - \"mock(\"\n      - \"patch(\"\n    specialist_agent: \"python-developer\"  # Language-specific\n    cost_estimate_tokens: 1000\n\n  # Gate 4: Mutation Testing\n  gate_4_mutation:\n    enabled: true\n    blocking: true\n    name: \"Mutation Testing\"\n    description: \"Validates mutation score ≥95% to ensure test effectiveness\"\n    validation_method: \"mutation_testing\"\n    threshold: 95                   # Mutation score percentage\n    specialist_agent: \"test-automation\"\n    cost_estimate_tokens: 3000\n    timeout_seconds: 600            # 10 minutes for mutation testing\n\n  # Gate 5: Security Validation\n  gate_5_security:\n    enabled: true\n    blocking: true\n    name: \"Security Validation\"\n    description: \"Scans for critical/high vulnerabilities and security issues\"\n    validation_method: \"security_scan\"\n    allowed_severity_levels:\n      - \"low\"\n      - \"informational\"\n    blocked_severity_levels:\n      - \"critical\"\n      - \"high\"\n    scan_tools:\n      - \"bandit\"         # Python security scanner\n      - \"safety\"         # Python dependency scanner\n      - \"semgrep\"        # Multi-language static analysis\n    specialist_agent: \"security-reviewer\"\n    cost_estimate_tokens: 2500\n\n  # Gate 6: Production-Ready Standards\n  gate_6_production_ready:\n    enabled: true\n    blocking: true\n    name: \"Production-Ready Standards\"\n    description: \"Validates completeness: no stubs, full error handling, comprehensive logging\"\n    validation_method: \"production_ready_scan\"\n    checks:\n      - \"no_stub_implementations\"\n      - \"complete_error_handling\"\n      - \"structured_logging\"\n      - \"no_unresolved_todos\"\n    completeness_threshold: 100     # Perfect score required\n    specialist_agent: \"architect-reviewer\"\n    cost_estimate_tokens: 2000\n\n# Failure Handling Configuration\nfailure_handling:\n  # 3-Strike Rule\n  retry_strategy: \"exponential_backoff\"\n  initial_retry_delay_seconds: 5\n  max_retry_delay_seconds: 60\n  backoff_multiplier: 2.0\n\n  # Specialist Consultation\n  consult_after_failures: 3         # Consult specialist after 3 failures\n  specialist_timeout_seconds: 300   # 5 minutes for specialist response\n\n  # Circuit Breaker\n  circuit_breaker:\n    enabled: true\n    threshold: 15                   # Consecutive failures\n    reset_after_success: true       # Reset counter on any successful gate\n    manual_intervention_required: true\n\n# Cost Optimization\ncost_optimization:\n  enable_context_sharing: true\n  enable_result_caching: true\n  cache_ttl:\n    coverage_results: 300           # 5 minutes\n    agent_responses: 600            # 10 minutes\n    file_contents: 900              # 15 minutes\n\n  # Estimated costs (USD) per gate with optimization\n  estimated_costs:\n    gate_1_tdd: 0.02\n    gate_2_coverage: 0.03\n    gate_3_mock: 0.015\n    gate_4_mutation: 0.045\n    gate_5_security: 0.0375\n    gate_6_production_ready: 0.03\n    total_per_prp: 0.1725           # ~40% savings vs non-optimized\n\n# Monitoring and Metrics\nmonitoring:\n  track_cost_savings: true\n  track_cache_hit_rate: true\n  track_gate_pass_rates: true\n  track_specialist_effectiveness: true\n  export_metrics_format: \"json\"\n  metrics_output_path: \".langgraph/metrics/\"\n","structuredPatch":[]}}
